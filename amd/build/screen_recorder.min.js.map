{"version":3,"file":"screen_recorder.min.js","sources":["../src/screen_recorder.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Tiny Poodll - screen recorder configuration.\n *\n * @module      tiny_poodll/screen_recorder\n * @copyright   2023 Justin Hunt <justin@poodll.com>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport BaseClass from './base_recorder';\nimport {component, SKIN} from \"./common\";\nimport * as Templates from 'core/templates';\n\n\nexport default class Screen extends BaseClass {\n\n    static fetchRecorderDimensions(config) {\n\n        // Get return object\n        var sizes = {};\n        sizes.videowidth = 441; //(because the @media CSS is for <=440)\n        sizes.videoheight = 540;\n        return sizes;\n    }\n\n    static getModalContext(editor) {\n        var tc = super.getModalContext(editor);\n        tc.isscreen=true;\n        tc.recorder = 'video'; //(audio or video or screen)\n\n        if(tc.subtitlevideobydefault){\n            tc.subtitling=true;\n        }else{\n            tc.subtitling=false;\n        }\n        return tc;\n    }\n\n    /**\n     * Creates the media html5 tags based on the recorder type.\n     *\n     * @method fetchMediaTags\n     * @param  {String} mediaurl media URL to the AWS object\n     * @param  {String} mediafilename File name of the AWS object\n     * @param  {String} sourceurl URL to the AWS object\n     * @param  {String} sourcemimetype MimeType of the AWS object\n     * @private\n     */\n    fetchMediaTags(mediaurl, mediafilename, sourceurl, sourcemimetype) {\n        var context = {};\n        context.url = mediaurl;\n        context.name = mediafilename;\n        context.issubtitling = this.config.subtitling && this.config.subtitling !== '0';\n        context.includesourcetrack = this.config.transcoding && (mediaurl !== sourceurl)\n            && (sourceurl.slice(-3) !== 'wav') && (sourceurl !== false);\n        context.CP = this.config.CP;\n        context.subtitleurl = mediaurl + '.vtt';\n        context.sourceurl = sourceurl;\n        context.sourcemimetype = sourcemimetype;\n        context.poster = false;\n        if (this.config.transcoding) {\n            context.urlmimetype = 'video/mp4';\n        } else {\n            context.urlmimetype = sourcemimetype;\n        }\n        return Templates.renderForPromise(\n            'tiny_poodll/videoplayer',\n            context\n        );\n    }\n}\n"],"names":["Screen","BaseClass","config","sizes","editor","tc","super","getModalContext","isscreen","recorder","subtitlevideobydefault","subtitling","fetchMediaTags","mediaurl","mediafilename","sourceurl","sourcemimetype","context","url","name","issubtitling","this","includesourcetrack","transcoding","slice","CP","subtitleurl","poster","urlmimetype","Templates","renderForPromise"],"mappings":";;;;;;;slCA4BqBA,eAAeC,sDAEDC,YAGvBC,MAAQ,CACZA,WAAmB,IACnBA,YAAoB,YACbA,6BAGYC,YACfC,GAAKC,MAAMC,gBAAgBH,eAC/BC,GAAGG,UAAS,EACZH,GAAGI,SAAW,QAEXJ,GAAGK,uBACFL,GAAGM,YAAW,EAEdN,GAAGM,YAAW,EAEXN,GAaXO,eAAeC,SAAUC,cAAeC,UAAWC,oBAC3CC,QAAU,UACdA,QAAQC,IAAML,SACdI,QAAQE,KAAOL,cACfG,QAAQG,aAAeC,KAAKnB,OAAOS,YAAyC,MAA3BU,KAAKnB,OAAOS,WAC7DM,QAAQK,mBAAqBD,KAAKnB,OAAOqB,aAAgBV,WAAaE,WACtC,QAAxBA,UAAUS,OAAO,KAAgC,IAAdT,UAC3CE,QAAQQ,GAAKJ,KAAKnB,OAAOuB,GACzBR,QAAQS,YAAcb,SAAW,OACjCI,QAAQF,UAAYA,UACpBE,QAAQD,eAAiBA,eACzBC,QAAQU,QAAS,EACbN,KAAKnB,OAAOqB,YACZN,QAAQW,YAAc,YAEtBX,QAAQW,YAAcZ,eAEnBa,UAAUC,iBACb,0BACAb"}