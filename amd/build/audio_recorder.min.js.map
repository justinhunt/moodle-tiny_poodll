{"version":3,"file":"audio_recorder.min.js","sources":["../src/audio_recorder.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Tiny Poodll - audio recorder configuration.\n *\n * @module      tiny_poodll/audio_recorder\n * @copyright   2023 Justin Hunt <justin@poodll.com>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport BaseClass from './base_recorder';\nimport Modal from './modal';\nimport ModalRegistry from 'core/modal_registry';\nimport * as ModalFactory from 'core/modal_factory';\nimport {component, SKIN} from \"./common\";\nimport * as Templates from 'core/templates';\n\n\nexport default class Audio extends BaseClass {\n\n    static fetchRecorderDimensions(config) {\n\n        // Get return object\n        var sizes = {};\n        switch (config.audioskin) {\n            default:\n                sizes.audiowidth = 450;\n                sizes.audioheight = 350;\n                break;\n        }\n        return sizes;\n    }\n\n\n    static getModalContext(editor) {\n        var tc = super.getModalContext(editor);\n        tc.isaudio=true;\n        tc.recorder = 'audio'; //(audio or video or screen)\n\n        if(tc.subtitleaudiobydefault){\n            tc.subtitling=true;\n        }else{\n            tc.subtitling=false;\n        }\n        return tc;\n    }\n\n    /**\n     * Creates the media html5 tags based on the recorder type.\n     *\n     * @method fetchMediaTags\n     * @param  mediaurl media URL to the AWS object\n     * @param  mediafilename File name of the AWS object\n     * @param  sourceurl URL to the AWS object\n     * @param  sourcemimetype MimeType of the AWS object\n     * @private\n     */\n    fetchMediaTags(mediaurl, mediafilename, sourceurl, sourcemimetype) {\n        var context = {};\n        context.url = mediaurl;\n        context.name = mediafilename;\n        context.issubtitling = this.config.subtitling && this.config.subtitling !== '0';\n        context.includesourcetrack = this.config.transcoding && (mediaurl !== sourceurl) && (sourceurl.slice(-3) !== 'wav') && (sourceurl !== false);\n        context.CP = this.config.CP;\n        context.subtitleurl = mediaurl + '.vtt';\n        context.sourceurl = sourceurl;\n        context.sourcemimetype = sourcemimetype;\n        context.poster = false;\n        if (this.config.transcoding) {\n            context.urlmimetype = 'audio/mp3';\n        } else {\n            context.urlmimetype = sourcemimetype;\n        }\n        return Templates.renderForPromise(\n            'tiny_poodll/audioplayer',\n            context\n        );\n    }\n}\n"],"names":["Audio","BaseClass","config","sizes","audioskin","audiowidth","audioheight","editor","tc","super","getModalContext","isaudio","recorder","subtitleaudiobydefault","subtitling","fetchMediaTags","mediaurl","mediafilename","sourceurl","sourcemimetype","context","url","name","issubtitling","this","includesourcetrack","transcoding","slice","CP","subtitleurl","poster","urlmimetype","Templates","renderForPromise"],"mappings":";;;;;;;+UA+BqBA,cAAcC,sDAEAC,YAGvBC,MAAQ,UACJD,OAAOE,UAEPD,MAAME,WAAa,IACnBF,MAAMG,YAAc,IAGrBH,6BAIYI,YACfC,GAAKC,MAAMC,gBAAgBH,eAC/BC,GAAGG,SAAQ,EACXH,GAAGI,SAAW,QAEXJ,GAAGK,uBACFL,GAAGM,YAAW,EAEdN,GAAGM,YAAW,EAEXN,GAaXO,eAAeC,SAAUC,cAAeC,UAAWC,oBAC3CC,QAAU,UACdA,QAAQC,IAAML,SACdI,QAAQE,KAAOL,cACfG,QAAQG,aAAeC,KAAKtB,OAAOY,YAAyC,MAA3BU,KAAKtB,OAAOY,WAC7DM,QAAQK,mBAAqBD,KAAKtB,OAAOwB,aAAgBV,WAAaE,WAAuC,QAAxBA,UAAUS,OAAO,KAAgC,IAAdT,UACxHE,QAAQQ,GAAKJ,KAAKtB,OAAO0B,GACzBR,QAAQS,YAAcb,SAAW,OACjCI,QAAQF,UAAYA,UACpBE,QAAQD,eAAiBA,eACzBC,QAAQU,QAAS,EACbN,KAAKtB,OAAOwB,YACZN,QAAQW,YAAc,YAEtBX,QAAQW,YAAcZ,eAEnBa,UAAUC,iBACb,0BACAb"}