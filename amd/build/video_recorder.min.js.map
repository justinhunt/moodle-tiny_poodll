{"version":3,"file":"video_recorder.min.js","sources":["../src/video_recorder.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Tiny Poodll - audio recorder configuration.\n *\n * @module      tiny_poodll/audio_recorder\n * @copyright   2023 Justin Hunt <justin@poodll.com>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport BaseClass from './base_recorder';\nimport {component, SKIN} from \"./common\";\nimport * as Templates from 'core/templates';\nimport Log from 'core/log';\n\n\nexport default class Video extends BaseClass {\n\n    static fetchRecorderDimensions(config) {\n\n        // Get return object\n        var sizes = {};\n        switch (config.videoskin) {\n            case SKIN.ONETWOTHREE:\n                sizes.videowidth = 441; //(because the @media CSS is for <=440)\n                sizes.videoheight = 540;\n                break;\n            case SKIN.BMR:\n                sizes.videowidth = 441; //(because the @media CSS is for <=440)\n                sizes.videoheight = 500;\n                break;\n            default:\n                sizes.videowidth = 441;\n                sizes.videoheight = 450;\n\n        }\n        return sizes;\n    }\n\n    static getModalContext(editor) {\n        var tc = super.getModalContext(editor);\n        tc.isvideo=true;\n        tc.recorder = 'video'; //(audio or video or screen)\n        //subtitles\n        if(tc.subtitlevideobydefault==='1'){\n            tc.subtitling=true;\n        }else{\n            tc.subtitling=false;\n        }\n        //insert method\n        tc.mediataginsert = (tc.insertmethod === 'tags');\n\n\n        return tc;\n    }\n\n\n    /**\n     * Creates the media html5 tags based on the recorder type.\n     *\n     * @method fetchMediaTags\n     * @param {String} mediaurl media URL to the AWS object\n     * @param {String} mediafilename File name of the AWS object\n     * @param {String} sourceurl URL to the AWS object\n     * @param  {String} sourcemimetype MimeType of the AWS object\n     * @private\n     */\n    fetchMediaTags(mediaurl, mediafilename, sourceurl, sourcemimetype) {\n        var context = {};\n        context.url = mediaurl;\n        context.name = mediafilename;\n        context.issubtitling = this.config.subtitling && this.config.subtitling !== '0';\n        var includesource = this.config.includesource == \"1\";\n        context.includesourcetrack = includesource && this.config.transcoding\n            && (mediaurl !== sourceurl)\n            && (sourceurl !== false);\n        context.CP = this.config.CP;\n        context.subtitleurl = mediaurl + '.vtt';\n        context.sourceurl = sourceurl;\n        context.sourcemimetype = sourcemimetype;\n        context.poster = false;\n        if (this.config.transcoding) {\n            context.urlmimetype = 'video/mp4';\n        } else {\n            context.urlmimetype = sourcemimetype;\n        }\n\n        return Templates.renderForPromise(\n            'tiny_poodll/videoplayer',\n            context\n        );\n    }\n}\n"],"names":["Video","BaseClass","config","sizes","videoskin","SKIN","ONETWOTHREE","videowidth","videoheight","BMR","editor","tc","super","getModalContext","isvideo","recorder","subtitlevideobydefault","subtitling","mediataginsert","insertmethod","fetchMediaTags","mediaurl","mediafilename","sourceurl","sourcemimetype","context","url","name","issubtitling","this","includesource","includesourcetrack","transcoding","CP","subtitleurl","poster","urlmimetype","Templates","renderForPromise"],"mappings":";;;;;;;q1BA6BqBA,cAAcC,sDAEAC,YAGvBC,MAAQ,UACJD,OAAOE,gBACNC,aAAKC,YACNH,MAAMI,WAAa,IACnBJ,MAAMK,YAAc,eAEnBH,aAAKI,IACNN,MAAMI,WAAa,IACnBJ,MAAMK,YAAc,kBAGpBL,MAAMI,WAAa,IACnBJ,MAAMK,YAAc,WAGrBL,6BAGYO,YACfC,GAAKC,MAAMC,gBAAgBH,eAC/BC,GAAGG,SAAQ,EACXH,GAAGI,SAAW,QAEiB,MAA5BJ,GAAGK,uBACFL,GAAGM,YAAW,EAEdN,GAAGM,YAAW,EAGlBN,GAAGO,eAAsC,SAApBP,GAAGQ,aAGjBR,GAcXS,eAAeC,SAAUC,cAAeC,UAAWC,oBAC3CC,QAAU,GACdA,QAAQC,IAAML,SACdI,QAAQE,KAAOL,cACfG,QAAQG,aAAeC,KAAK3B,OAAOe,YAAyC,MAA3BY,KAAK3B,OAAOe,eACzDa,cAA6C,KAA7BD,KAAK3B,OAAO4B,qBAChCL,QAAQM,mBAAqBD,eAAiBD,KAAK3B,OAAO8B,aAClDX,WAAaE,YACC,IAAdA,UACRE,QAAQQ,GAAKJ,KAAK3B,OAAO+B,GACzBR,QAAQS,YAAcb,SAAW,OACjCI,QAAQF,UAAYA,UACpBE,QAAQD,eAAiBA,eACzBC,QAAQU,QAAS,EACbN,KAAK3B,OAAO8B,YACZP,QAAQW,YAAc,YAEtBX,QAAQW,YAAcZ,eAGnBa,UAAUC,iBACb,0BACAb"}